{"ast":null,"code":"import _objectSpread from\"C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,Link,useNavigate}from'react-router-dom';import{ref,onValue,push,set,update,get}from'firebase/database';import{database}from'../firebase';import{useAuth}from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PostDetail=()=>{const{id}=useParams();const{currentUser}=useAuth();const navigate=useNavigate();const[post,setPost]=useState(null);const[comments,setComments]=useState([]);const[loading,setLoading]=useState(true);const[commentContent,setCommentContent]=useState('');const[userRating,setUserRating]=useState(0);const[hoverRating,setHoverRating]=useState(0);const[errorMessage,setErrorMessage]=useState('');useEffect(()=>{// Lấy chi tiết bài viết\nconst postRef=ref(database,\"posts/\".concat(id));const postUnsubscribe=onValue(postRef,snapshot=>{if(snapshot.exists()){setPost(_objectSpread({id},snapshot.val()));}else{// Bài viết không tồn tại\nnavigate('/not-found');}setLoading(false);});// Lấy danh sách bình luận\nconst commentsRef=ref(database,\"comments/\".concat(id));const commentsUnsubscribe=onValue(commentsRef,snapshot=>{const commentsData=snapshot.val()||{};const commentsArray=Object.keys(commentsData).map(commentId=>_objectSpread({id:commentId},commentsData[commentId])).sort((a,b)=>b.createdAt-a.createdAt);setComments(commentsArray);});// Kiểm tra xem người dùng đã đánh giá bài viết chưa\nif(currentUser){const checkUserRating=async()=>{const ratingsRef=ref(database,\"ratings/\".concat(id));const snapshot=await get(ratingsRef);if(snapshot.exists()){const ratingsData=snapshot.val();const userRatingEntry=Object.values(ratingsData).find(rating=>rating.userId===currentUser.uid);if(userRatingEntry){setUserRating(userRatingEntry.score);}}};checkUserRating();}return()=>{postUnsubscribe();commentsUnsubscribe();};},[id,navigate,currentUser]);const handleCommentSubmit=async e=>{e.preventDefault();if(!currentUser){navigate('/login');return;}if(!commentContent.trim()){setErrorMessage('Vui lòng nhập nội dung bình luận');return;}try{const newCommentRef=push(ref(database,\"comments/\".concat(id)));await set(newCommentRef,{userId:currentUser.uid,userName:currentUser.displayName||'Người dùng ẩn danh',content:commentContent,createdAt:Date.now(),parentCommentId:null});setCommentContent('');setErrorMessage('');}catch(error){console.error('Lỗi khi thêm bình luận:',error);setErrorMessage('Có lỗi xảy ra khi đăng bình luận. Vui lòng thử lại sau.');}};const handleRating=async rating=>{if(!currentUser){navigate('/login');return;}try{// Lưu đánh giá vào database\nconst ratingData={userId:currentUser.uid,score:rating,createdAt:Date.now()};// Kiểm tra xem người dùng đã đánh giá trước đó chưa\nconst ratingsRef=ref(database,\"ratings/\".concat(id));const snapshot=await get(ratingsRef);if(snapshot.exists()){const ratingsData=snapshot.val();const existingRatingKey=Object.keys(ratingsData).find(key=>ratingsData[key].userId===currentUser.uid);if(existingRatingKey){// Cập nhật đánh giá hiện có\nawait update(ref(database,\"ratings/\".concat(id,\"/\").concat(existingRatingKey)),{score:rating,createdAt:Date.now()});}else{// Thêm đánh giá mới\nawait push(ref(database,\"ratings/\".concat(id)),ratingData);}}else{// Thêm đánh giá đầu tiên\nawait push(ref(database,\"ratings/\".concat(id)),ratingData);}// Cập nhật trung bình đánh giá và số lượng đánh giá\nconst updatedSnapshot=await get(ratingsRef);const ratings=updatedSnapshot.val()||{};const ratingValues=Object.values(ratings);const totalScore=ratingValues.reduce((sum,r)=>sum+r.score,0);const ratingCount=ratingValues.length;const averageRating=totalScore/ratingCount;await update(ref(database,\"posts/\".concat(id)),{averageRating,ratingCount});setUserRating(rating);}catch(error){console.error('Lỗi khi đánh giá:',error);setErrorMessage('Có lỗi xảy ra khi đánh giá. Vui lòng thử lại sau.');}};const formatDate=timestamp=>{const date=new Date(timestamp);return date.toLocaleDateString('vi-VN',{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})});}return/*#__PURE__*/_jsx(\"div\",{className:\"post-detail-container fade-in\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-wrapper\",children:[/*#__PURE__*/_jsxs(\"article\",{className:\"post-detail\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"post-detail-header\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"post-detail-title\",children:post.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-meta\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-author\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user\"}),\" \",post.authorName||'Người dùng ẩn danh']}),post.category&&/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-category\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-folder\"}),\" \",post.category]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-date\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-calendar-alt\"}),\" \",formatDate(post.createdAt)]})]})]}),post.imageUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"post-detail-image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:post.imageUrl,alt:post.title,className:\"post-detail-image\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"post-detail-content\",children:post.content.split('\\n').map((paragraph,i)=>paragraph?/*#__PURE__*/_jsx(\"p\",{children:paragraph},i):/*#__PURE__*/_jsx(\"br\",{},i))}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-footer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-detail-stats\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-eye\"}),\" \",post.viewCount||0,\" l\\u01B0\\u1EE3t xem\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"far fa-star\"}),\" \",post.averageRating?\"\".concat(post.averageRating.toFixed(1),\"/5 (\").concat(post.ratingCount,\" l\\u01B0\\u1EE3t)\"):'Chưa có đánh giá']})]}),/*#__PURE__*/_jsx(\"div\",{className:\"post-detail-tags\",children:post.tags&&post.tags.split(',').map((tag,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"post-detail-tag\",children:tag.trim()},index))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rating-section\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u0110\\xE1nh gi\\xE1 b\\xE0i vi\\u1EBFt\"}),/*#__PURE__*/_jsx(\"div\",{className:\"rating\",children:[1,2,3,4,5].map(star=>/*#__PURE__*/_jsx(\"span\",{className:\"star \".concat((hoverRating||userRating)>=star?'filled':''),onClick:()=>handleRating(star),onMouseEnter:()=>setHoverRating(star),onMouseLeave:()=>setHoverRating(0),children:\"\\u2605\"},star))}),userRating>0&&/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0110\\xE1nh gi\\xE1 c\\u1EE7a b\\u1EA1n: \",userRating,\"/5\"]})]})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"comments-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"comments-header\",children:[\"B\\xECnh lu\\u1EADn (\",comments.length,\")\"]}),/*#__PURE__*/_jsxs(\"form\",{className:\"comment-form\",onSubmit:handleCommentSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"comment\",children:\"\\u0110\\u1EC3 l\\u1EA1i b\\xECnh lu\\u1EADn c\\u1EE7a b\\u1EA1n:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"comment\",value:commentContent,onChange:e=>setCommentContent(e.target.value),placeholder:currentUser?\"Nhập bình luận của bạn...\":\"Đăng nhập để bình luận...\",disabled:!currentUser})]}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMessage}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:!currentUser,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-paper-plane\"}),\" \\u0110\\u0103ng b\\xECnh lu\\u1EADn\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:comments.length>0?comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-author\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"comment-author-avatar\",children:comment.userName.charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{children:comment.userName})]}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-date\",children:formatDate(comment.createdAt)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-content\",children:comment.content})]},comment.id)):/*#__PURE__*/_jsx(\"p\",{className:\"no-comments\",children:\"Ch\\u01B0a c\\xF3 b\\xECnh lu\\u1EADn n\\xE0o. H\\xE3y l\\xE0 ng\\u01B0\\u1EDDi \\u0111\\u1EA7u ti\\xEAn b\\xECnh lu\\u1EADn!\"})})]})]})});};export default PostDetail;","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","useNavigate","ref","onValue","push","set","update","get","database","useAuth","jsx","_jsx","jsxs","_jsxs","PostDetail","id","currentUser","navigate","post","setPost","comments","setComments","loading","setLoading","commentContent","setCommentContent","userRating","setUserRating","hoverRating","setHoverRating","errorMessage","setErrorMessage","postRef","concat","postUnsubscribe","snapshot","exists","_objectSpread","val","commentsRef","commentsUnsubscribe","commentsData","commentsArray","Object","keys","map","commentId","sort","a","b","createdAt","checkUserRating","ratingsRef","ratingsData","userRatingEntry","values","find","rating","userId","uid","score","handleCommentSubmit","e","preventDefault","trim","newCommentRef","userName","displayName","content","Date","now","parentCommentId","error","console","handleRating","ratingData","existingRatingKey","key","updatedSnapshot","ratings","ratingValues","totalScore","reduce","sum","r","ratingCount","length","averageRating","formatDate","timestamp","date","toLocaleDateString","year","month","day","hour","minute","className","children","title","authorName","category","imageUrl","src","alt","split","paragraph","i","viewCount","toFixed","tags","tag","index","star","onClick","onMouseEnter","onMouseLeave","onSubmit","htmlFor","value","onChange","target","placeholder","disabled","type","comment","charAt","toUpperCase"],"sources":["C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/src/pages/PostDetail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, Link, useNavigate } from 'react-router-dom';\nimport { ref, onValue, push, set, update, get } from 'firebase/database';\nimport { database } from '../firebase';\nimport { useAuth } from '../context/AuthContext';\n\nconst PostDetail = () => {\n  const { id } = useParams();\n  const { currentUser } = useAuth();\n  const navigate = useNavigate();\n\n  const [post, setPost] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [commentContent, setCommentContent] = useState('');\n  const [userRating, setUserRating] = useState(0);\n  const [hoverRating, setHoverRating] = useState(0);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  useEffect(() => {\n    // Lấy chi tiết bài viết\n    const postRef = ref(database, `posts/${id}`);\n    const postUnsubscribe = onValue(postRef, (snapshot) => {\n      if (snapshot.exists()) {\n        setPost({\n          id,\n          ...snapshot.val()\n        });\n      } else {\n        // Bài viết không tồn tại\n        navigate('/not-found');\n      }\n      setLoading(false);\n    });\n\n    // Lấy danh sách bình luận\n    const commentsRef = ref(database, `comments/${id}`);\n    const commentsUnsubscribe = onValue(commentsRef, (snapshot) => {\n      const commentsData = snapshot.val() || {};\n      const commentsArray = Object.keys(commentsData).map(commentId => ({\n        id: commentId,\n        ...commentsData[commentId]\n      })).sort((a, b) => b.createdAt - a.createdAt);\n\n      setComments(commentsArray);\n    });\n\n    // Kiểm tra xem người dùng đã đánh giá bài viết chưa\n    if (currentUser) {\n      const checkUserRating = async () => {\n        const ratingsRef = ref(database, `ratings/${id}`);\n        const snapshot = await get(ratingsRef);\n\n        if (snapshot.exists()) {\n          const ratingsData = snapshot.val();\n          const userRatingEntry = Object.values(ratingsData).find(\n            rating => rating.userId === currentUser.uid\n          );\n\n          if (userRatingEntry) {\n            setUserRating(userRatingEntry.score);\n          }\n        }\n      };\n\n      checkUserRating();\n    }\n\n    return () => {\n      postUnsubscribe();\n      commentsUnsubscribe();\n    };\n  }, [id, navigate, currentUser]);\n\n  const handleCommentSubmit = async (e) => {\n    e.preventDefault();\n\n    if (!currentUser) {\n      navigate('/login');\n      return;\n    }\n\n    if (!commentContent.trim()) {\n      setErrorMessage('Vui lòng nhập nội dung bình luận');\n      return;\n    }\n\n    try {\n      const newCommentRef = push(ref(database, `comments/${id}`));\n\n      await set(newCommentRef, {\n        userId: currentUser.uid,\n        userName: currentUser.displayName || 'Người dùng ẩn danh',\n        content: commentContent,\n        createdAt: Date.now(),\n        parentCommentId: null\n      });\n\n      setCommentContent('');\n      setErrorMessage('');\n    } catch (error) {\n      console.error('Lỗi khi thêm bình luận:', error);\n      setErrorMessage('Có lỗi xảy ra khi đăng bình luận. Vui lòng thử lại sau.');\n    }\n  };\n\n  const handleRating = async (rating) => {\n    if (!currentUser) {\n      navigate('/login');\n      return;\n    }\n\n    try {\n      // Lưu đánh giá vào database\n      const ratingData = {\n        userId: currentUser.uid,\n        score: rating,\n        createdAt: Date.now()\n      };\n\n      // Kiểm tra xem người dùng đã đánh giá trước đó chưa\n      const ratingsRef = ref(database, `ratings/${id}`);\n      const snapshot = await get(ratingsRef);\n\n      if (snapshot.exists()) {\n        const ratingsData = snapshot.val();\n        const existingRatingKey = Object.keys(ratingsData).find(\n          key => ratingsData[key].userId === currentUser.uid\n        );\n\n        if (existingRatingKey) {\n          // Cập nhật đánh giá hiện có\n          await update(ref(database, `ratings/${id}/${existingRatingKey}`), {\n            score: rating,\n            createdAt: Date.now()\n          });\n        } else {\n          // Thêm đánh giá mới\n          await push(ref(database, `ratings/${id}`), ratingData);\n        }\n      } else {\n        // Thêm đánh giá đầu tiên\n        await push(ref(database, `ratings/${id}`), ratingData);\n      }\n\n      // Cập nhật trung bình đánh giá và số lượng đánh giá\n      const updatedSnapshot = await get(ratingsRef);\n      const ratings = updatedSnapshot.val() || {};\n      const ratingValues = Object.values(ratings);\n      const totalScore = ratingValues.reduce((sum, r) => sum + r.score, 0);\n      const ratingCount = ratingValues.length;\n      const averageRating = totalScore / ratingCount;\n\n      await update(ref(database, `posts/${id}`), {\n        averageRating,\n        ratingCount\n      });\n\n      setUserRating(rating);\n    } catch (error) {\n      console.error('Lỗi khi đánh giá:', error);\n      setErrorMessage('Có lỗi xảy ra khi đánh giá. Vui lòng thử lại sau.');\n    }\n  };\n\n  const formatDate = (timestamp) => {\n    const date = new Date(timestamp);\n    return date.toLocaleDateString('vi-VN', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"loading\">\n        <div className=\"spinner\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"post-detail-container fade-in\">\n      <div className=\"post-detail-wrapper\">\n        <article className=\"post-detail\">\n          <header className=\"post-detail-header\">\n            <h1 className=\"post-detail-title\">{post.title}</h1>\n            <div className=\"post-detail-meta\">\n              <div className=\"post-detail-author\">\n                <i className=\"fas fa-user\"></i> {post.authorName || 'Người dùng ẩn danh'}\n              </div>\n              {post.category && (\n                <div className=\"post-detail-category\">\n                  <i className=\"fas fa-folder\"></i> {post.category}\n                </div>\n              )}\n              <div className=\"post-detail-date\">\n                <i className=\"far fa-calendar-alt\"></i> {formatDate(post.createdAt)}\n              </div>\n            </div>\n          </header>\n\n          {post.imageUrl && (\n            <div className=\"post-detail-image-container\">\n              <img src={post.imageUrl} alt={post.title} className=\"post-detail-image\" />\n            </div>\n          )}\n\n          <div className=\"post-detail-content\">\n            {post.content.split('\\n').map((paragraph, i) => (\n              paragraph ? <p key={i}>{paragraph}</p> : <br key={i} />\n            ))}\n          </div>\n\n          <div className=\"post-detail-footer\">\n            <div className=\"post-detail-stats\">\n              <span><i className=\"far fa-eye\"></i> {post.viewCount || 0} lượt xem</span>\n              <span><i className=\"far fa-star\"></i> {post.averageRating ? `${post.averageRating.toFixed(1)}/5 (${post.ratingCount} lượt)` : 'Chưa có đánh giá'}</span>\n            </div>\n\n            <div className=\"post-detail-tags\">\n              {post.tags && post.tags.split(',').map((tag, index) => (\n                <span key={index} className=\"post-detail-tag\">{tag.trim()}</span>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"rating-section\">\n            <h3>Đánh giá bài viết</h3>\n            <div className=\"rating\">\n              {[1, 2, 3, 4, 5].map((star) => (\n                <span\n                  key={star}\n                  className={`star ${(hoverRating || userRating) >= star ? 'filled' : ''}`}\n                  onClick={() => handleRating(star)}\n                  onMouseEnter={() => setHoverRating(star)}\n                  onMouseLeave={() => setHoverRating(0)}\n                >\n                  ★\n                </span>\n              ))}\n            </div>\n            {userRating > 0 && <p>Đánh giá của bạn: {userRating}/5</p>}\n          </div>\n        </article>\n\n        <section className=\"comments-section\">\n          <h2 className=\"comments-header\">Bình luận ({comments.length})</h2>\n\n          <form className=\"comment-form\" onSubmit={handleCommentSubmit}>\n            <div className=\"form-group\">\n              <label htmlFor=\"comment\">Để lại bình luận của bạn:</label>\n              <textarea\n                id=\"comment\"\n                value={commentContent}\n                onChange={(e) => setCommentContent(e.target.value)}\n                placeholder={currentUser ? \"Nhập bình luận của bạn...\" : \"Đăng nhập để bình luận...\"}\n                disabled={!currentUser}\n              ></textarea>\n            </div>\n            {errorMessage && <p className=\"error-message\">{errorMessage}</p>}\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={!currentUser}>\n              <i className=\"fas fa-paper-plane\"></i> Đăng bình luận\n            </button>\n          </form>\n\n          <div className=\"comments-list\">\n            {comments.length > 0 ? (\n              comments.map(comment => (\n                <div className=\"comment\" key={comment.id}>\n                  <div className=\"comment-header\">\n                    <div className=\"comment-author\">\n                      <div className=\"comment-author-avatar\">\n                        {comment.userName.charAt(0).toUpperCase()}\n                      </div>\n                      <span>{comment.userName}</span>\n                    </div>\n                    <span className=\"comment-date\">{formatDate(comment.createdAt)}</span>\n                  </div>\n                  <div className=\"comment-content\">{comment.content}</div>\n                </div>\n              ))\n            ) : (\n              <p className=\"no-comments\">Chưa có bình luận nào. Hãy là người đầu tiên bình luận!</p>\n            )}\n          </div>\n        </section>\n      </div>\n    </div>\n  );\n};\n\nexport default PostDetail;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}