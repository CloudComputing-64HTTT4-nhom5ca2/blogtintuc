{"ast":null,"code":"import _objectSpread from\"C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{database}from'../../firebase';import{ref,onValue,remove}from'firebase/database';import AdminSidebar from'../../components/AdminSidebar';import'../../styles/Admin.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ManageComments=()=>{const[comments,setComments]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const commentsRef=ref(database,'comments/');onValue(commentsRef,snapshot=>{const data=snapshot.val();const commentsList=[];if(data){// Duyệt qua từng bài post có comment\nObject.keys(data).forEach(postId=>{const postComments=data[postId];// Duyệt qua từng comment trong bài post\nif(postComments){Object.keys(postComments).forEach(commentId=>{commentsList.push(_objectSpread({id:commentId,postId},postComments[commentId]));});}});}setComments(commentsList);setLoading(false);});},[]);const handleDelete=async(postId,commentId)=>{try{await remove(ref(database,\"comments/\".concat(postId,\"/\").concat(commentId)));}catch(error){console.error(\"Lỗi khi xóa bình luận:\",error);}};const truncateText=function(text){let maxLength=arguments.length>1&&arguments[1]!==undefined?arguments[1]:50;if(!text)return'';return text.length>maxLength?text.substring(0,maxLength)+'...':text;};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(AdminSidebar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"admin-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(AdminSidebar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-header\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"admin-title\",children:\"Qu\\u1EA3n l\\xFD b\\xECnh lu\\u1EADn\"}),/*#__PURE__*/_jsx(\"div\",{className:\"admin-actions\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"admin-count\",children:[comments.length,\" b\\xECnh lu\\u1EADn\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"posts-table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"posts-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"N\\u1ED9i dung\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\xE0y t\\u1EA1o\"}),/*#__PURE__*/_jsx(\"th\",{children:\"H\\xE0nh \\u0111\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:comments.length>0?comments.map(comment=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:truncateText(comment.id,8)}),/*#__PURE__*/_jsx(\"td\",{children:truncateText(comment.content,50)}),/*#__PURE__*/_jsx(\"td\",{children:comment.userName||'Người dùng ẩn danh'}),/*#__PURE__*/_jsx(\"td\",{children:comment.createdAt?new Date(comment.createdAt).toLocaleDateString('vi-VN'):'Không rõ'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn-delete\",onClick:()=>handleDelete(comment.postId,comment.id),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-trash\"}),\" X\\xF3a\"]})})]},comment.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"5\",className:\"no-data\",children:\"Ch\\u01B0a c\\xF3 b\\xECnh lu\\u1EADn n\\xE0o.\"})})})]})})]})]});};export default ManageComments;","map":{"version":3,"names":["React","useEffect","useState","database","ref","onValue","remove","AdminSidebar","jsx","_jsx","jsxs","_jsxs","ManageComments","comments","setComments","loading","setLoading","commentsRef","snapshot","data","val","commentsList","Object","keys","forEach","postId","postComments","commentId","push","_objectSpread","id","handleDelete","concat","error","console","truncateText","text","maxLength","arguments","length","undefined","substring","className","children","map","comment","content","userName","createdAt","Date","toLocaleDateString","onClick","colSpan"],"sources":["C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/src/pages/admin/ManageComments.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { database } from '../../firebase';\nimport { ref, onValue, remove } from 'firebase/database';\nimport AdminSidebar from '../../components/AdminSidebar';\nimport '../../styles/Admin.css';\n\nconst ManageComments = () => {\n  const [comments, setComments] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const commentsRef = ref(database, 'comments/');\n    onValue(commentsRef, (snapshot) => {\n      const data = snapshot.val();\n      const commentsList = [];\n\n      if (data) {\n        // Duyệt qua từng bài post có comment\n        Object.keys(data).forEach(postId => {\n          const postComments = data[postId];\n          // Duyệt qua từng comment trong bài post\n          if (postComments) {\n            Object.keys(postComments).forEach(commentId => {\n              commentsList.push({\n                id: commentId,\n                postId,\n                ...postComments[commentId]\n              });\n            });\n          }\n        });\n      }\n\n      setComments(commentsList);\n      setLoading(false);\n    });\n  }, []);\n\n  const handleDelete = async (postId, commentId) => {\n    try {\n      await remove(ref(database, `comments/${postId}/${commentId}`));\n    } catch (error) {\n      console.error(\"Lỗi khi xóa bình luận:\", error);\n    }\n  };\n\n  const truncateText = (text, maxLength = 50) => {\n    if (!text) return '';\n    return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"admin-container\">\n        <AdminSidebar />\n        <div className=\"admin-content\">\n          <div className=\"loading\">\n            <div className=\"spinner\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"admin-container\">\n      <AdminSidebar />\n\n      <div className=\"admin-content\">\n        <div className=\"admin-header\">\n          <h1 className=\"admin-title\">Quản lý bình luận</h1>\n          <div className=\"admin-actions\">\n            <span className=\"admin-count\">{comments.length} bình luận</span>\n          </div>\n        </div>\n\n        <div className=\"posts-table-container\">\n          <table className=\"posts-table\">\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Nội dung</th>\n                <th>Người dùng</th>\n                <th>Ngày tạo</th>\n                <th>Hành động</th>\n              </tr>\n            </thead>\n            <tbody>\n              {comments.length > 0 ? (\n                comments.map(comment => (\n                  <tr key={comment.id}>\n                    <td>{truncateText(comment.id, 8)}</td>\n                    <td>{truncateText(comment.content, 50)}</td>\n                    <td>{comment.userName || 'Người dùng ẩn danh'}</td>\n                    <td>{comment.createdAt ? new Date(comment.createdAt).toLocaleDateString('vi-VN') : 'Không rõ'}</td>\n                    <td>\n                      <button\n                        className=\"btn-delete\"\n                        onClick={() => handleDelete(comment.postId, comment.id)}\n                      >\n                        <i className=\"fas fa-trash\"></i> Xóa\n                      </button>\n                    </td>\n                  </tr>\n                ))\n              ) : (\n                <tr>\n                  <td colSpan=\"5\" className=\"no-data\">Chưa có bình luận nào.</td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ManageComments;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}