{"ast":null,"code":"import _objectSpread from\"C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import{database}from'../../firebase';import{ref,onValue,update}from'firebase/database';import AdminSidebar from'../../components/AdminSidebar';import'../../styles/Admin.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ManageUsers=()=>{const[users,setUsers]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const usersRef=ref(database,'users/');onValue(usersRef,snapshot=>{const data=snapshot.val();const usersList=data?Object.keys(data).map(key=>_objectSpread({id:key},data[key])):[];setUsers(usersList);setLoading(false);});},[]);const handleToggleRole=async user=>{const newRole=user.role==='admin'?'user':'admin';try{await update(ref(database,\"users/\".concat(user.id)),{role:newRole});}catch(error){console.error(\"Lỗi khi thay đổi quyền người dùng:\",error);}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(AdminSidebar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"admin-content\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})})})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsx(AdminSidebar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"admin-header\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"admin-title\",children:\"Qu\\u1EA3n l\\xFD ng\\u01B0\\u1EDDi d\\xF9ng\"}),/*#__PURE__*/_jsx(\"div\",{className:\"admin-actions\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"admin-count\",children:[users.length,\" ng\\u01B0\\u1EDDi d\\xF9ng\"]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"posts-table-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"posts-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"T\\xEAn hi\\u1EC3n th\\u1ECB\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Vai tr\\xF2\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Ng\\xE0y \\u0111\\u0103ng k\\xFD\"}),/*#__PURE__*/_jsx(\"th\",{children:\"H\\xE0nh \\u0111\\u1ED9ng\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.length>0?users.map(user=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"td\",{children:[user.id.substring(0,8),\"...\"]}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsx(\"td\",{children:user.displayName||'Chưa đặt tên'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"span\",{className:\"role-badge \".concat(user.role==='admin'?'admin':'user'),children:user.role==='admin'?'Quản trị viên':'Người dùng'})}),/*#__PURE__*/_jsx(\"td\",{children:user.createdAt?new Date(user.createdAt).toLocaleDateString('vi-VN'):'Không rõ'}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-role \".concat(user.role==='admin'?'demote':'promote'),onClick:()=>handleToggleRole(user),children:user.role==='admin'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user\"}),\" H\\u1EA1 quy\\u1EC1n\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-shield\"}),\" N\\xE2ng quy\\u1EC1n\"]})})})]},user.id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",className:\"no-data\",children:\"Ch\\u01B0a c\\xF3 ng\\u01B0\\u1EDDi d\\xF9ng n\\xE0o.\"})})})]})})]})]});};export default ManageUsers;","map":{"version":3,"names":["React","useEffect","useState","database","ref","onValue","update","AdminSidebar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ManageUsers","users","setUsers","loading","setLoading","usersRef","snapshot","data","val","usersList","Object","keys","map","key","_objectSpread","id","handleToggleRole","user","newRole","role","concat","error","console","className","children","length","substring","email","displayName","createdAt","Date","toLocaleDateString","onClick","colSpan"],"sources":["C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/src/pages/admin/ManageUsers.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { database } from '../../firebase';\nimport { ref, onValue, update } from 'firebase/database';\nimport AdminSidebar from '../../components/AdminSidebar';\nimport '../../styles/Admin.css';\n\nconst ManageUsers = () => {\n  const [users, setUsers] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const usersRef = ref(database, 'users/');\n    onValue(usersRef, (snapshot) => {\n      const data = snapshot.val();\n      const usersList = data ? Object.keys(data).map(key => ({ id: key, ...data[key] })) : [];\n      setUsers(usersList);\n      setLoading(false);\n    });\n  }, []);\n\n  const handleToggleRole = async (user) => {\n    const newRole = user.role === 'admin' ? 'user' : 'admin';\n    try {\n      await update(ref(database, `users/${user.id}`), { role: newRole });\n    } catch (error) {\n      console.error(\"Lỗi khi thay đổi quyền người dùng:\", error);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"admin-container\">\n        <AdminSidebar />\n        <div className=\"admin-content\">\n          <div className=\"loading\">\n            <div className=\"spinner\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"admin-container\">\n      <AdminSidebar />\n\n      <div className=\"admin-content\">\n        <div className=\"admin-header\">\n          <h1 className=\"admin-title\">Quản lý người dùng</h1>\n          <div className=\"admin-actions\">\n            <span className=\"admin-count\">{users.length} người dùng</span>\n          </div>\n        </div>\n\n        <div className=\"posts-table-container\">\n          <table className=\"posts-table\">\n            <thead>\n              <tr>\n                <th>ID</th>\n                <th>Email</th>\n                <th>Tên hiển thị</th>\n                <th>Vai trò</th>\n                <th>Ngày đăng ký</th>\n                <th>Hành động</th>\n              </tr>\n            </thead>\n            <tbody>\n              {users.length > 0 ? (\n                users.map(user => (\n                  <tr key={user.id}>\n                    <td>{user.id.substring(0, 8)}...</td>\n                    <td>{user.email}</td>\n                    <td>{user.displayName || 'Chưa đặt tên'}</td>\n                    <td>\n                      <span className={`role-badge ${user.role === 'admin' ? 'admin' : 'user'}`}>\n                        {user.role === 'admin' ? 'Quản trị viên' : 'Người dùng'}\n                      </span>\n                    </td>\n                    <td>{user.createdAt ? new Date(user.createdAt).toLocaleDateString('vi-VN') : 'Không rõ'}</td>\n                    <td>\n                      <button\n                        className={`btn-role ${user.role === 'admin' ? 'demote' : 'promote'}`}\n                        onClick={() => handleToggleRole(user)}\n                      >\n                        {user.role === 'admin' ? (\n                          <><i className=\"fas fa-user\"></i> Hạ quyền</>\n                        ) : (\n                          <><i className=\"fas fa-user-shield\"></i> Nâng quyền</>\n                        )}\n                      </button>\n                    </td>\n                  </tr>\n                ))\n              ) : (\n                <tr>\n                  <td colSpan=\"6\" className=\"no-data\">Chưa có người dùng nào.</td>\n                </tr>\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ManageUsers;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}