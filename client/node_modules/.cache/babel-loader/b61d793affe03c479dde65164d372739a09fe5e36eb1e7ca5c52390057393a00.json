{"ast":null,"code":"import _objectSpread from\"C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{ref,onValue,query,orderByChild,limitToLast}from'firebase/database';import{database}from'../firebase';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const[posts,setPosts]=useState([]);const[loading,setLoading]=useState(true);const[selectedCategory,setSelectedCategory]=useState('all');const[categories,setCategories]=useState([]);useEffect(()=>{// Lấy danh sách bài viết từ Realtime Database\nconst postsRef=query(ref(database,'posts'),orderByChild('createdAt'));const unsubscribe=onValue(postsRef,snapshot=>{const postsData=snapshot.val()||{};// Chuyển đổi đối tượng thành mảng và sắp xếp theo thời gian tạo (mới nhất trước)\nconst postsArray=Object.keys(postsData).map(id=>_objectSpread({id},postsData[id])).sort((a,b)=>b.createdAt-a.createdAt);setPosts(postsArray);// Lấy danh sách danh mục\nconst uniqueCategories=[...new Set(postsArray.map(post=>post.category))];setCategories(uniqueCategories);setLoading(false);});// Hủy đăng ký lắng nghe khi component bị hủy\nreturn()=>unsubscribe();},[]);// Lọc bài viết theo danh mục\nconst filteredPosts=selectedCategory==='all'?posts:posts.filter(post=>post.category===selectedCategory);return/*#__PURE__*/_jsxs(\"div\",{className:\"home\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center mb-3\",children:\"Blog Tin T\\u1EE9c\"}),/*#__PURE__*/_jsx(\"div\",{className:\"category-filter mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"\".concat(selectedCategory==='all'?'btn-primary':'btn-secondary'),onClick:()=>setSelectedCategory('all'),children:\"T\\u1EA5t c\\u1EA3\"}),categories.map(category=>/*#__PURE__*/_jsx(\"button\",{className:\"\".concat(selectedCategory===category?'btn-primary':'btn-secondary'),onClick:()=>setSelectedCategory(category),style:{marginLeft:'10px'},children:category},category))]})}),loading?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})}):filteredPosts.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"post-list\",children:filteredPosts.map(post=>/*#__PURE__*/_jsxs(\"div\",{className:\"post-card\",children:[post.imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:post.imageUrl,alt:post.title,className:\"post-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-content\",children:[/*#__PURE__*/_jsx(Link,{to:\"/post/\".concat(post.id),className:\"post-title\",children:/*#__PURE__*/_jsx(\"h2\",{children:post.title})}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-meta\",children:[/*#__PURE__*/_jsx(\"span\",{children:post.category}),/*#__PURE__*/_jsxs(\"span\",{children:[\"T\\xE1c gi\\u1EA3: \",post.authorName]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"L\\u01B0\\u1EE3t xem: \",post.viewCount||0]}),/*#__PURE__*/_jsx(\"span\",{children:post.averageRating?/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u2B50 \",post.averageRating.toFixed(1),\"/5 (\",post.ratingCount,\")\"]}):/*#__PURE__*/_jsx(\"span\",{children:\"Ch\\u01B0a c\\xF3 \\u0111\\xE1nh gi\\xE1\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"post-excerpt\",children:[post.content.substring(0,150),\"...\"]}),/*#__PURE__*/_jsx(Link,{to:\"/post/\".concat(post.id),className:\"btn btn-primary\",children:\"\\u0110\\u1ECDc ti\\u1EBFp\"})]})]},post.id))}):/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:\"Kh\\xF4ng c\\xF3 b\\xE0i vi\\u1EBFt n\\xE0o trong danh m\\u1EE5c n\\xE0y.\"})]});};export default Home;","map":{"version":3,"names":["React","useState","useEffect","Link","ref","onValue","query","orderByChild","limitToLast","database","jsx","_jsx","jsxs","_jsxs","Home","posts","setPosts","loading","setLoading","selectedCategory","setSelectedCategory","categories","setCategories","postsRef","unsubscribe","snapshot","postsData","val","postsArray","Object","keys","map","id","_objectSpread","sort","a","b","createdAt","uniqueCategories","Set","post","category","filteredPosts","filter","className","children","concat","onClick","style","marginLeft","length","imageUrl","src","alt","title","to","authorName","viewCount","averageRating","toFixed","ratingCount","content","substring"],"sources":["C:/Users/User/OneDrive/Documents/VSCode/web/WebAPPP/client/src/pages/Home.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport { ref, onValue, query, orderByChild, limitToLast } from 'firebase/database';\nimport { database } from '../firebase';\n\nconst Home = () => {\n  const [posts, setPosts] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedCategory, setSelectedCategory] = useState('all');\n  const [categories, setCategories] = useState([]);\n\n  useEffect(() => {\n    // Lấy danh sách bài viết từ Realtime Database\n    const postsRef = query(ref(database, 'posts'), orderByChild('createdAt'));\n\n    const unsubscribe = onValue(postsRef, (snapshot) => {\n      const postsData = snapshot.val() || {};\n\n      // Chuyển đổi đối tượng thành mảng và sắp xếp theo thời gian tạo (mới nhất trước)\n      const postsArray = Object.keys(postsData).map(id => ({\n        id,\n        ...postsData[id]\n      })).sort((a, b) => b.createdAt - a.createdAt);\n\n      setPosts(postsArray);\n\n      // Lấy danh sách danh mục\n      const uniqueCategories = [...new Set(postsArray.map(post => post.category))];\n      setCategories(uniqueCategories);\n\n      setLoading(false);\n    });\n\n    // Hủy đăng ký lắng nghe khi component bị hủy\n    return () => unsubscribe();\n  }, []);\n\n  // Lọc bài viết theo danh mục\n  const filteredPosts = selectedCategory === 'all'\n    ? posts\n    : posts.filter(post => post.category === selectedCategory);\n\n  return (\n    <div className=\"home\">\n      <h1 className=\"text-center mb-3\">Blog Tin Tức</h1>\n\n      {/* Bộ lọc danh mục */}\n      <div className=\"category-filter mb-3\">\n        <div className=\"container\">\n          <button\n            className={`${selectedCategory === 'all' ? 'btn-primary' : 'btn-secondary'}`}\n            onClick={() => setSelectedCategory('all')}\n          >\n            Tất cả\n          </button>\n\n          {categories.map(category => (\n            <button\n              key={category}\n              className={`${selectedCategory === category ? 'btn-primary' : 'btn-secondary'}`}\n              onClick={() => setSelectedCategory(category)}\n              style={{ marginLeft: '10px' }}\n            >\n              {category}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {loading ? (\n        <div className=\"loading\">\n          <div className=\"spinner\"></div>\n        </div>\n      ) : filteredPosts.length > 0 ? (\n        <div className=\"post-list\">\n          {filteredPosts.map(post => (\n            <div key={post.id} className=\"post-card\">\n              {post.imageUrl && (\n                <img src={post.imageUrl} alt={post.title} className=\"post-image\" />\n              )}\n              <div className=\"post-content\">\n                <Link to={`/post/${post.id}`} className=\"post-title\">\n                  <h2>{post.title}</h2>\n                </Link>\n                <div className=\"post-meta\">\n                  <span>{post.category}</span>\n                  <span>Tác giả: {post.authorName}</span>\n                </div>\n                <div className=\"post-meta\">\n                  <span>Lượt xem: {post.viewCount || 0}</span>\n                  <span>\n                    {post.averageRating ? (\n                      <span>⭐ {post.averageRating.toFixed(1)}/5 ({post.ratingCount})</span>\n                    ) : (\n                      <span>Chưa có đánh giá</span>\n                    )}\n                  </span>\n                </div>\n                <div className=\"post-excerpt\">\n                  {post.content.substring(0, 150)}...\n                </div>\n                <Link to={`/post/${post.id}`} className=\"btn btn-primary\">\n                  Đọc tiếp\n                </Link>\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <p className=\"text-center\">Không có bài viết nào trong danh mục này.</p>\n      )}\n    </div>\n  );\n};\n\nexport default Home;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}